<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

    <changeSet id="1" author="ZQian">
        <comment>Oauth Tables</comment>
        <sql>
            -- ----------------------------
            -- Table structure for oauth_access_token
            -- ----------------------------
            DROP TABLE IF EXISTS `oauth_access_token`;
            CREATE TABLE `oauth_access_token` (
            `token_id` varchar(255) NOT NULL,
            `authentication` longblob,
            `authentication_id` varchar(255) DEFAULT NULL,
            `client_id` varchar(255) DEFAULT NULL,
            `refresh_token` varchar(255) DEFAULT NULL,
            `token` longblob,
            `user_name` varchar(255) DEFAULT NULL,
            PRIMARY KEY (`token_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for oauth_approvals
            -- ----------------------------
            DROP TABLE IF EXISTS `oauth_approvals`;
            CREATE TABLE `oauth_approvals` (
            `user_id` varchar(255) NOT NULL,
            `client_id` varchar(255) NOT NULL,
            `expires_at` datetime(6) DEFAULT NULL,
            `last_modified_at` datetime(6) DEFAULT NULL,
            `scope` varchar(255) DEFAULT NULL,
            `status` varchar(255) DEFAULT NULL,
            PRIMARY KEY (`user_id`,`client_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for oauth_client_details
            -- ----------------------------
            DROP TABLE IF EXISTS `oauth_client_details`;
            CREATE TABLE `oauth_client_details` (
            `client_id` varchar(255) NOT NULL,
            `access_token_validity` int(11) DEFAULT NULL,
            `additional_information` varchar(4096) DEFAULT NULL,
            `authorities` varchar(255) DEFAULT NULL,
            `authorized_grant_types` varchar(255) DEFAULT NULL,
            `auto_approve_scopes` varchar(255) DEFAULT NULL,
            `autoapprove` varchar(255) DEFAULT NULL,
            `client_secret` varchar(255) DEFAULT NULL,
            `refresh_token_validity` int(11) DEFAULT NULL,
            `resource_ids` varchar(255) DEFAULT NULL,
            `scope` varchar(255) DEFAULT NULL,
            `web_server_redirect_uri` varchar(2048) DEFAULT NULL,
            PRIMARY KEY (`client_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for oauth_code
            -- ----------------------------
            DROP TABLE IF EXISTS `oauth_code`;
            CREATE TABLE `oauth_code` (
            `code` varchar(255) NOT NULL,
            `authentication` longblob,
            PRIMARY KEY (`code`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for oauth_refresh_token
            -- ----------------------------
            DROP TABLE IF EXISTS `oauth_refresh_token`;
            CREATE TABLE `oauth_refresh_token` (
            `token_id` varchar(255) NOT NULL,
            `authentication_id` varchar(255) DEFAULT NULL,
            `client_id` varchar(255) DEFAULT NULL,
            `token` longblob,
            `user_name` varchar(255) DEFAULT NULL,
            `authentication` longblob,
            PRIMARY KEY (`token_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
        </sql>
    </changeSet>

    <changeSet id="2" author="ZQian">
        <comment>User Tables</comment>
        <sql>
            -- ----------------------------
            -- Table structure for groups
            -- ----------------------------
            DROP TABLE IF EXISTS `groups`;
            CREATE TABLE `groups` (
            `id` bigint(20) NOT NULL,
            `name` varchar(255) DEFAULT NULL,
            `version` bigint(20) DEFAULT NULL,
            `description` varchar(255) DEFAULT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_idx` (`name`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for groups_roles
            -- ----------------------------
            DROP TABLE IF EXISTS `groups_roles`;
            CREATE TABLE `groups_roles` (
            `group_id` bigint(20) NOT NULL,
            `role_id` bigint(20) NOT NULL,
            PRIMARY KEY (`group_id`,`role_id`) USING BTREE,
            KEY `FKid1t6hsoewrpxb3lyn42xktlx` (`role_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;


            -- ----------------------------
            -- Table structure for roles
            -- ----------------------------
            DROP TABLE IF EXISTS `roles`;
            CREATE TABLE `roles` (
            `id` bigint(20) NOT NULL,
            `description` varchar(255) DEFAULT NULL,
            `name` varchar(255) DEFAULT NULL,
            `version` bigint(20) DEFAULT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_idx` (`name`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for roles_permissions
            -- ----------------------------
            DROP TABLE IF EXISTS `roles_permissions`;
            CREATE TABLE `roles_permissions` (
            `role_id` bigint(20) NOT NULL,
            `permission_id` bigint(20) NOT NULL,
            PRIMARY KEY (`role_id`,`permission_id`) USING BTREE,
            UNIQUE KEY `UK_oll9subcln0cdjt31bp72a3uv` (`permission_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for routers
            -- ----------------------------
            DROP TABLE IF EXISTS `routers`;
            CREATE TABLE `routers` (
            `id` bigint(20) NOT NULL,
            `always_show` bit(1) DEFAULT NULL,
            `component` varchar(255) DEFAULT NULL,
            `hidden` bit(1) DEFAULT NULL,
            `meta` json DEFAULT NULL,
            `name` varchar(255) DEFAULT NULL,
            `path` varchar(255) DEFAULT NULL,
            `redirect` varchar(255) DEFAULT NULL,
            `parent_id` bigint(20) DEFAULT NULL,
            `version` bigint(20) DEFAULT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_idx` (`name`),
            KEY `FKg1s4y6tj0gj1k609mru7qd87a` (`parent_id`),
            CONSTRAINT `FKg1s4y6tj0gj1k609mru7qd87a` FOREIGN KEY (`parent_id`) REFERENCES `routers` (`id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for users
            -- ----------------------------
            DROP TABLE IF EXISTS `users`;
            CREATE TABLE `users` (
            `id` bigint(20) NOT NULL,
            `enabled` bit(1) DEFAULT NULL,
            `password` varchar(255) DEFAULT NULL,
            `username` varchar(255) DEFAULT NULL,
            `version` bigint(20) DEFAULT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `username_idx` (`username`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for users_groups
            -- ----------------------------
            DROP TABLE IF EXISTS `users_groups`;
            CREATE TABLE `users_groups` (
            `user_id` bigint(20) NOT NULL,
            `group_id` bigint(20) NOT NULL,
            PRIMARY KEY (`user_id`,`group_id`) USING BTREE,
            KEY `FKbeo8kwu4ixgcr3nk17cwjjfmb` (`group_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            -- ----------------------------
            -- Table structure for users_roles
            -- ----------------------------
            DROP TABLE IF EXISTS `users_roles`;
            CREATE TABLE `users_roles` (
            `user_id` bigint(20) NOT NULL,
            `role_id` bigint(20) NOT NULL,
            PRIMARY KEY (`user_id`,`role_id`) USING BTREE,
            KEY `FKa62j07k5mhgifpp955h37ponj` (`role_id`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

            SET FOREIGN_KEY_CHECKS = 1;


            -- ----------------------------
            -- Table structure for permissions
            -- ----------------------------
            DROP TABLE IF EXISTS `permissions`;
            CREATE TABLE `permissions` (
            `id` bigint(20) NOT NULL,
            `description` varchar(255) DEFAULT NULL,
            `name` varchar(255) DEFAULT NULL,
            `version` bigint(20) DEFAULT NULL,
            PRIMARY KEY (`id`),
            UNIQUE KEY `name_idx` (`name`)
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8;

        </sql>
    </changeSet>

    <changeSet id="3" author="ZQian">
        <comment>Oauth Data</comment>
        <sql>
            -- ----------------------------
            -- Records of oauth_client_details
            -- ----------------------------
            INSERT INTO `oauth_client_details` VALUES ('auth-front', 7200, '{}', '', 'password,client_credentials',
            NULL, '', '$2a$10$1YTXZBBwjzdJR1L8HffAU.bE.psL8GdDlncaxiwuLSO/3XBLDNVXG', 2592000, '', 'all', '');
            INSERT INTO `oauth_client_details` VALUES ('auth-manager', 7200, '{}', '', 'client_credentials', NULL, '',
            '$2a$10$0mSva5D2egHRA2Amue0wxuETIGaVqYnzsQKck4ULxHccZrRWL2x5W', 2592000, '', 'all', '');
        </sql>
    </changeSet>

    <changeSet id="4" author="ZQian">
        <comment>User Data</comment>
        <sql>
            -- ----------------------------
            -- Records of groups
            -- ----------------------------
            INSERT INTO `groups` VALUES (1, 'admin', NULL, NULL);
            -- ----------------------------
            -- Records of permissions
            -- ----------------------------
            INSERT INTO `permissions` VALUES (1, NULL, 'admin', NULL);
            -- ----------------------------
            -- Records of roles
            -- ----------------------------
            INSERT INTO `roles` VALUES (1, NULL, 'admin', NULL);
            -- ----------------------------
            -- Records of users
            -- ----------------------------
            INSERT INTO `users` VALUES (1, b'1', '$2a$10$/vhjXa7hSTGBJAkcuVRdB.MhVQjnpAcK5Oe8n1tk1COHxenPu0WSO',
            'admin', NULL);
            -- ----------------------------
            -- Records of Relations
            -- ----------------------------
            INSERT INTO `users_groups` VALUES (1, 1);
            INSERT INTO `groups_roles` VALUES (1, 1);
            INSERT INTO `roles_permissions` VALUES (1, 1);
        </sql>
    </changeSet>

</databaseChangeLog>